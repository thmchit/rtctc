<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>리;듬칫듬칫</title>
    <link href="./../common.css" rel="stylesheet">
    <link href="./style.css" rel="stylesheet">
    <script src="../../node_modules/rhy-game/dist/rhy-game.js"></script>
    <script src="../../data/mapList.js"></script>
</head>
<body onkeydown="play()">
    <div id="monitor">
        <!--monitor 내의 다른 모든 element는 반드시 common-monitor 이후에 있어야함-->
        <div class="common-monitor">
            <div class="judgement-line"></div>
        </div>
        <div class="common-monitor">
            <div class="judgement-line"></div>
        </div>
        
        <div class="lane _0 down"></div>
        <div class="lane _1 down"></div>
        <div class="lane _2 down"></div>
        <div class="lane _3 down"></div>
        <div class="lane _4 down"></div>
        <div class="lane _5 down"></div>

        <div class="lane _0 up"></div>
        <div class="lane _1 up"></div>
        <div class="lane _2 up"></div>
        <div class="lane _3 up"></div>
        <div class="lane _4 up"></div>
        <div class="lane _5 up"></div>
    </div>

    <script>
        function play() {
            const url = new URL(window.location.href)
            const params = new URLSearchParams(url.search)
            game.play(mapList[params.get('index')], params.get('mode'))
            document.body.removeAttribute('onkeydown')
        }

        const game = new Game({
            DOM: {
                d0: document.getElementsByClassName('lane')[0],
                d1: document.getElementsByClassName('lane')[1],
                d2: document.getElementsByClassName('lane')[2],
                d3: document.getElementsByClassName('lane')[3],
                d4: document.getElementsByClassName('lane')[4],
                d5: document.getElementsByClassName('lane')[5],

                u5: document.getElementsByClassName('lane')[6],
                u4: document.getElementsByClassName('lane')[7],
                u3: document.getElementsByClassName('lane')[8],
                u2: document.getElementsByClassName('lane')[9],
                u1: document.getElementsByClassName('lane')[10],
                u0: document.getElementsByClassName('lane')[11]
            },
            notes: {
                s: (lane, index) => new Normal(lane, index, { classNames: ['note', 'short'] }),
                l: (lane, index) => new Long(lane, index, { classNames: ['note', 'long'] })
            },
            sizePerBeat: window.innerWidth > window.innerHeight
                ? '12.5vh' : '12.5vw',
            laneSizeRatio: 8,
            delay: -400
        })
    </script>
</body>
</html>